{
    "collab_server" : "",
    "contents" : "library(bigrquery)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(knitr)\n\n######### FUNCION FECHA ###########\n\nfecha <- function(input_date){\n  year <- substr(input_date,1,4);\n  month <- substr(input_date,5,6);\n  day <- substr(input_date,7,8);\n  out_date <- paste(year,month,day,sep = \"-\")\n  return(out_date)}\n\n\n######### CONEXION BIGQUERY ###########\n# BigQuery project Id - NH\nBQ_PROJECT_ID <- \"useful-art-91609\";\n#BigQuery NH DataSet for Google Analytics Premium\n#BQ_DATASET_ID <- NH_pred;\n\n### ExtracciÃ³n de los datos para el html de las variables booleanas ###\n\nquery_generalb <- function(cd){\n  query <- paste(\"\n                 SELECT\n                 cd,\n                 ROUND(MAX(frecuencia),2) as max,\n                 ROUND(MIN(frecuencia),2) as min,\n                 ROUND(AVG(frecuencia),2) as avg\n                 FROM(\n                 SELECT\n                 date,\n                 cd,\n                 Count(cookie_id) as frecuencia,  \n                 from(\n                 SELECT \n                 date,\n                 fullVisitorId as cookie_id,\n                 MAX(IF(\",cd,\",hits.customDimensions.value,NULL)) within record AS cd\n                 FROM TABLE_DATE_RANGE([94438972.ga_sessions_],TIMESTAMP('20160922'),TIMESTAMP('20161222')))\n                 GROUP BY 1,2)\n                 GROUP BY 1\n                 \")\n  data <- query_exec(query=query, project = BQ_PROJECT_ID,max_pages = Inf)\n  data\n}\nquery_generalb_total <- function(cd){\n  query <- paste(\"\n                 SELECT\n                 cd,\n                 sum(frecuencia)\n                 FROM(\n                 SELECT\n                 date,\n                 cd,\n                 Count(cookie_id) as frecuencia,  \n                 from(\n                 SELECT \n                 date,\n                 fullVisitorId as cookie_id,\n                 MAX(IF(\",cd,\",hits.customDimensions.value,NULL)) within record AS cd\n                 FROM TABLE_DATE_RANGE([94438972.ga_sessions_],TIMESTAMP('20160922'),TIMESTAMP('20161222')))\n                 GROUP BY 1,2)\n                 GROUP BY 1\n                 \")\n  data <- query_exec(query=query, project = BQ_PROJECT_ID,max_pages = Inf)\n  data\n}\nquery_evolb <- function(cd){\n  query <- paste(\"            \n                 SELECT\n                 date,\n                 cd as cd,\n                 Count(cd) as frecuencia                 \n                 FROM (\n                 SELECT \n                 date,\n                 fullVisitorId as cookie_id,\n                 MAX(IF(\",cd,\",hits.customDimensions.value,NULL)) within record AS cd\n                 FROM TABLE_DATE_RANGE([94438972.ga_sessions_],TIMESTAMP('20160922'),TIMESTAMP('20161222')))\n                 GROUP BY 1,2\n                 \")\n  data <- query_exec(query=query, project = BQ_PROJECT_ID,max_pages = Inf)\n  data\n}\nquery_general_20b <- function(cd){\n  query <- paste(\"                 \n                 SELECT date,\n                 cookie_id,\n                 count(cd) as freq,\n                 FROM(\n                 SELECT \n                 date,\n                 fullVisitorId as cookie_id,\n                 MAX(IF(\",cd,\",hits.customDimensions.value,NULL)) within hits AS cd\n                 FROM TABLE_DATE_RANGE([94438972.ga_sessions_],TIMESTAMP('20160922'),TIMESTAMP('20161222'))\n                 where hits.type = 'PAGE')\n                 group by 1,2\n                 order by freq desc\n                 limit 20\n                 \")\n  data <- query_exec(query=query, project = BQ_PROJECT_ID,max_pages = Inf)\n  data\n}\n\n### Fin del programa de las queries ###",
    "created" : 1486398435114.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "23|31|46|0|\n69|28|85|0|\n86|34|104|0|\n",
    "hash" : "1258612997",
    "id" : "2B7A3C64",
    "lastKnownWriteTime" : 1486463311,
    "last_content_update" : 1486463311681,
    "path" : "C:/Clientes/NH/Proyecto Modelo predictivo/Entregable HTML/func_booleanas.R",
    "project_path" : "func_booleanas.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}